<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원 탈퇴</title>
    <link rel="stylesheet" href="../css/member/deletemember.css">
    <link rel="stylesheet" href="../css/header-footer.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<!-- 헤더 부분 -->
<th:block th:replace="fragments/header.html"></th:block>

<main>
    <div class="delete-container">
        <h2>회원 탈퇴</h2>
        <div class="form-content">
            <div class="form-inputs">
                <div class="form-group">
                    <label for="password">비밀번호 입력</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="button" id="deleteButton" class="submit-btn">회원 탈퇴</button>
            </div>
            <div class="form-message">
                <h3>꼭! 아래 내용을 확인해주세요</h3>
                <div class="form-message-box">
                    회원 탈퇴 시 모든 개인 정보와 활동 내역이 삭제됩니다.<br>
                    이 작업은 되돌릴 수 없으므로 신중하게 결정해 주시기 바랍니다.
                </div>
            </div>
        </div>
    </div>
</main>
<!-- 메인태그 닫고 로고 푸터 시작  -->
<th:block th:replace="fragments/footer.html"></th:block>

<script th:inline="javascript">
    $(document).ready(function() {
        $('#deleteButton').click(function() {
            var password = $('#password').val();
            if (!password) {
                alert('비밀번호를 입력해주세요.');
                return;
            }

            if (confirm('정말로 탈퇴하시겠습니까? 이 작업은 되돌릴 수 없습니다.')) {
                $.ajax({
                    url: /*[[@{/member/delete}]]*/ '/member/delete',
                    type: 'POST',
                    data: { password: password },
                    success: function(response) {
                        alert('회원 탈퇴가 완료되었습니다.');
                        window.location.href = /*[[@{/}]]*/ '/';
                    },
                    error: function(xhr, status, error) {
                        alert('회원 탈퇴 처리 중 오류가 발생했습니다: ' + xhr.responseText);
                    }
                });
            }
        });
    });
</script>
</body>

</html>